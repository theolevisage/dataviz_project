version: "3"

services:
  mariadb:
    build: ./MariaDB/
    volumes:
      - ./MariaDB/init/:/docker-entrypoint-initdb.d/
    environment:
      MARIADB_ROOT_USER: root
      MARIADB_ROOT_PASSWORD: root123
      MARIADB_DATABASE: datas
    ports:
      - "3306:3306"

  collector:
    build: ./Collecteur/
    volumes:
      - ./Collecteur/scripts:/scripts
    environment:
      - NAME=collector
      - MAIL=collector@email.com
      - PYTHONUNBUFFERED=1
    ports:
      - "65432:65432"
    depends_on:
      - mariadb

  api:
    build: ./API/
    ports:
      - "8081:8080"
    depends_on:
      - mariadb

  nginx:
    build: ./Nginx/front_dataviz_js/
    ports:
      - "81:80"
    depends_on:
      - api

  unit1:
    build: ./UniteProd/
    volumes:
      - ./UniteProd/scripts:/scripts
    environment:
      - UNITE_NUMBER=1
      - UID='unite1 unite1@email.com'
      - PYTHONUNBUFFERED=1
    depends_on:
      - collector

  unit2:
    build: ./UniteProd/
    volumes:
      - ./UniteProd/scripts:/scripts
    environment:
      - UNITE_NUMBER=2
      - UID='unit2 unit2@email.com'
      - PYTHONUNBUFFERED=1
    depends_on:
      - collector

  unit3:
    build: ./UniteProd/
    volumes:
      - ./UniteProd/scripts:/scripts
    environment:
      - UNITE_NUMBER=3
      - UID='unit3 unit3@email.com'
      - PYTHONUNBUFFERED=1
    depends_on:
      - collector

  unit4:
    build: ./UniteProd/
    volumes:
      - ./UniteProd/scripts:/scripts
    environment:
      - UNITE_NUMBER=4
      - UID='unit4 unit4@email.com'
      - PYTHONUNBUFFERED=1
    depends_on:
      - collector

  unit5:
    build: ./UniteProd/
    volumes:
      - ./UniteProd/scripts:/scripts
    environment:
      - UNITE_NUMBER=5
      - UID='unite5 unite5@email.com'
      - PYTHONUNBUFFERED=1
    depends_on:
      - collector